\chapter{Engineering inequalities and intuition, from equalities}
\label{ch2:inequalities}

This section will demonstrate how the form of the \gls{GP} (monomial
equalities and posynomial inequalities) helps engineers gain intuition
about the way that each variable is pressured
by a given objective function. Please refer to Appendices~\ref{a:gpintro} and ~\ref{a:spintro}
for detailed descriptions of the forms of \gls{GP}s and \gls{SP}s respectively.
The intuition gained in turn helps formulate
constraints that can properly bound each variable in the model.
GPkit, \gls{CEG}'s \gls{GP} modeling framework,
facilitates process by providing feedback to designers about
the boundedness of a model.

A simple aircraft optimization problem named SimPleAC\footnote{S and P have been capitalized to designate that
the model will be a 'signomial program', and AC is an acronym for 'aircraft'.} will be derived and will serve as
a demonstration of the intuitive structure of geometric and signomial programs, and show
how we can introduce new constraints to bound the feasibility sets of models.

\section{Making feasibility sets and boundedness explicit}

Consider the simple design problem below, where we define a simple bilinear
monomial equality with respect to $x$ and $y$, and constrain the sum of the variables
to be less than 2:

\begin{equation*}
\begin{aligned}
& {\text{minimize}}
& & x \\
& \text{subject to}
& & x + y \leq 2,
    & & & xy = \frac{1}{2} \label{simple_moneq}
\end{aligned}
\end{equation*}

We can draw the feasibility set of the above problem in both linear and log space,
as shown in Figure~\ref{f:feas_moneq}. One expects that, given only two variables
related through an equality and bounded by inequalities, the feasibility space is
a finite line segment in log-space, and a finite exponential function in linear space.
The black dot in Figure~\ref{f:feas_moneq} is the global optimum of the feasibility set
($x = 1 - \frac{1}{\sqrt{2}}$, $y = 1 + \frac{1}{\sqrt{2}}$).

\begin{figure}
    \centering
    \includegraphics[width=0.8\textwidth]{feas_moneq.png}
    \caption{The $x$-$y$ feasibility set of a simple monomial equality.}
    \label{f:feas_moneq}
\end{figure}

However, if we had decided to impose $xy \geq \frac{1}{2}$ instead of $xy = \frac{1}{2}$,
then we would get a new feasibility set as shown in Figure~\ref{f:feas_posygeq}.
Using the \gls{GP} form, we can always upper-bound posynomials, and lower-bound both posynomials
and monomials to get convex feasible sets. Note that the optimal point, which is at
$x = 1 - \frac{1}{\sqrt{2}}$, $y = 1 + \frac{1}{\sqrt{2}}$,
does not change when the monomial equality is relaxed. This is a key
observation that will allow us to turn the equalities in most physical models into \gls{GP}-compatible
posynomial inequalities. The posynomial equality relaxation is explained in greater detail
in~\cite{hoburg_thesis}.

\begin{figure}
    \centering
    \includegraphics[width=0.8\textwidth]{feas_posygeq.png}
    \caption{The $x$-$y$ feasibility set of lower-bounding monomial,
    and upper-bounding posynomial.}
    \label{f:feas_posygeq}
\end{figure}

However if we convert the monomial equality to  $xy \leq \frac{1}{2}$, we will get an unbounded model,
whose feasibility set is shown in Figure~\ref{f:feas_posyleq}.
Since minimizing $x$ is our objective, and both variables are upper-bounded,
they both collapse towards numerical precision zero,
giving a vanishing feasibility set shown in Figure~\ref{f:feas_posyleq}. This section will
demonstrate methods to create \gls{GP}-compatible models that are adequately bounded to avoid such
singularities towards zero or infinity, which for the most part do not
exist in real physical models. The models will be created within GPkit~\cite{gpkit}.

\begin{figure}
    \centering
    \includegraphics[width=0.8\textwidth]{feas_posyleq.png}
    \caption{The $x$-$y$ feasibility set of upper-bounding monomial,
    and upper-bounding posynomial.}
    \label{f:feas_posyleq}
\end{figure}

\section{Defining the design problem}

\gls{GP}s are amenable to solving a large variety of design problems (see~\cite{gpintro} for an
extensive number of examples). This thesis uses aircraft design to demonstrate
design methodologies that leverage convex optimization since the author's background is in aerospace engineering.
Aircraft epitomize the nature of complex engineering problems. The physical 
relations describing their motion are nonlinear, and all of their subsystems are 
coupled through the primary forces in flight (thrust, weight, lift, drag).
The goal of the aircraft in question will be to perform a basic `ferry' mission, that
is to carry a given payload
over a distance while minimizing an objective function.

\subsection{Objective functions}
\label{s:objective}

Objective functions are the way that a designer puts pressure on the variables 
in the constraints. To begin with, we will consider
total fuel weight $W_f$ as our objective, which will put
downward pressure on all of the variables that would cause greater fuel burn, namely
drag and weight. We must necessarily lower-bound all variables in the objective function
that have positive exponents, and upper-bound all variables with negative exponents.

In many design problems
formulated as \gls{GP}s, many different objectives will put pressure on design
in the same direction. For example, an aircraft optimized for fuel weight will look
different compared to one
that has been designed for total weight or payload-fuel consumption, but each
of these objectives will put a downward pressure on drag and weight.
As such, this model will be able to take in a number of objective functions
and be properly constrained and bounded. According to Raymer, an important
principle of aircraft design is `that there is no such thing as a free lunch!'
~\cite[pg.26]{raymer}. An improvement in any of the other objective functions
will result in reduced performance with respect to others.

\subsection{Functional description: constraining the problem}

The typical process for designing anything usually involves doing either a
component decomposition or a functional decomposition of the problem. In
this case, we will think about the functional decomposition to create a
basic list of constraints that our aircraft will need to fulfill to be
able to capture the tradeoffs in an aircraft design problem. (In
Section~\ref{s:submodels}, we will examine how thinking about the component decomposition
can help structure larger problems.)

What does an aircraft need to be able to do to deliver payload of a distance?
\begin{itemize}
	\item It will need to sustain steady
    level flight, keeping itself and the payload aloft (Section~\ref{s:wl}).
    \item It will need to overcome drag (Section~\ref{s:td}).
	\item It will need to contain enough fuel to complete its mission
        (Section~\ref{s:fuel}).
	\item It will need to be able to sustain its structural loads (Section~\ref{s:wingstrc}).
\end{itemize}

Note that these are in no way presented in order of importance, which is reflective
of the non-hierarchical nature of \gls{GP}s.
In the basic example, we will choose not to model engines,
and leave this as an exercise
to complete in Section~\ref{s:engine} to improve the model.

\section{GP Modeling from Physics}

Optimization model creation often starts haphazardly, with the designer having a
vague idea about the set of physics that govern a problem, and some basic
assumptions about the configuration. In this section, we will
generate variables and constraints with abandon, and think about how to make
sure each variable is adequately bounded later. Each subsection is intended
to introduce the reader to an important aspect of \gls{GP} modeling,
accompanied by examples in implementation.

\subsection{Free and fixed variables: modeling weight and lift}
\label{s:wl}

For this particular design problem, we start by modeling
weight and lift, since one fundamental function of the aircraft is to stay aloft.
The aircraft has weight, which consists of the payload, wing, and fuel weights. 

\begin{equation}
    W \geq W_p + W_w + W_f
\end{equation}

Note that we have already had to make determination about the relation between
the two sides of the equation. Heavier aircraft burn more fuel, so we are justified
to put total weight as greater than the sum of the component weights since
$W$ will be pressured downward by the objective. Furthermore, we can
always add more weight to the aircraft by adding ballast to it, even if this would likely
worsen the objective. So we allow for slackness in this constraint, even
if we know intuitively that it will almost always be tight as explained in Section~\ref{s:objective}.

The aircraft has to sustain steady level flight, which means
that it needs to generate enough lift to carry itself. We use the naive
lift is greater than weight ($L \geq W$)
model below for steady state flight:

\begin{equation}
   \frac{1}{2} \rho V^2 S C_L  \geq  W_p + W_w + 0.5 W_f
\end{equation}

where the lift of the aircraft is equal to weight of the aircraft with half-fuel, 
which is a crude estimate of the average weight of the aircraft throughout the flight.
Again, the \gls{GP} form is seamless here, since lift is related to
induced drag, and so it is pressured downward into the posynomial on the \gls{RHS} of the equation.

We would also like the fully-fueled aircraft to be able to fly at a minimum speed 
of $V_{min}$ without stalling, so we add the following constraint:

\begin{equation}
    W \leq \frac{1}{2} \rho V_{min}^2 S C_{L_{max}}
\end{equation}

Note that, although we could use a monomial equality here, we don't, because this
relation does not need to be tight. It is acceptable that the aircraft is able to
fly at a velocity slower than $V_{min}$ for a given objective function.

At this point, we have introduced a large set of variables, some of which are input
parameters, and the others free variables. The decision of whether to keep variables free or fixed
can shape the whole model development process in all forms of optimization.
The decision can be influenced by many
factors in a \gls{GP}, with four in particular that stand out in this model.
We set the lift coefficient and takeoff speed
to be constants since (I) we would need
more detailed modeling to determine their values. Payload weight is set
because (II) it would always be unbounded towards zero due to the downward pressure from
the objective. A designer may also fix variables (III) if he/she knows their values with
certainty (e.g.\ gravitational acceleration $g$) or (IV) the variable is a normalizing
coefficient (which we will see in Section~\ref{s:datafit}).
The variables have been defined in Table~\ref{t:vars_WandL}, where the variables that
have associated values are fixed variables.
The remaining variables are free variables, to be optimized once the model
is appropriately bounded.

\begin{footnotesize}
\begin{table}
    \centering
    \begin{tabular}{ l c c l}
        \toprule
        \textbf{Variable} & \textbf{Value} & \textbf{Units} & \textbf{Description} \\
        \midrule
        $\rho$ & 1.23 & $~\mathrm{\tfrac{kg}{m^{3}}}$ & density of air \\
        $C_L$ & \ldots & $~\mathrm{-}$ & wing lift coefficient \\
        $C_{L,max}$ & 1.6 & $~\mathrm{-}$ & lift coefficient at stall \\
        $S$ & \ldots & $~\mathrm{m^{2}}$ & total wing area \\
        $V$ & \ldots & $~\mathrm{\tfrac{m}{s}}$ & cruising speed \\
        $V_{min}$ & 25 & $~\mathrm{\tfrac{m}{s}}$ & takeoff speed \\
        $W$ & \ldots & $~\mathrm{N}$ & total aircraft weight \\
        $W_f$ & \ldots & $~\mathrm{N}$ & fuel weight \\
        $W_w$ & \ldots & $~\mathrm{N}$ & wing weight \\
        $W_p$ & 6250 & $~\mathrm{N}$ & payload weight \\
        \bottomrule
    \end{tabular}
    \caption{Variables introduced in weight vs. lift model.}
    \label{t:vars_WandL}
\end{table} \end{footnotesize}

Note that the atmospheric variable $\rho$ in Table~\ref{t:vars_TandD}, and other
atmospheric variables in Section~\ref{ch2:inequalities} are set
to be constant. The behavior of these variables with altitude
will be modeled in more detail in Section~\ref{s:mission} when
the flight profile of the aircraft is modeled.

\subsection{Alternate objectives: adding performance metrics}
\label{s:altobj}

As multi-objective designers, we may also be interested in knowing about
additional performance metrics that can serve as part of objective functions. A
few that are particularly relevant to aircraft will be introduced here.

The time of flight of the aircraft, which is a useful metric to calculate cost,
is simply the aircraft's range divided by its cruise velocity:

\begin{equation}
    T_{flight} \geq \frac{\mathrm{Range}}{V}
\end{equation}

The lift-to-drag ratio is also defined: 

\begin{equation}
    L/D = \frac{C_L}{C_D}    
\end{equation}

The new variables we have introduced are detailed in Table~\ref{t:vars_perfMetrics}.

\begin{footnotesize}
\begin{table}
    \centering
    \begin{tabular}{ l c c l}
        \toprule
        \textbf{Variable} & \textbf{Value} & \textbf{Units} & \textbf{Description} \\
        \midrule
        $C_D$ & \ldots & $~\mathrm{-}$ & drag coefficient \\
        $C_L$ & \ldots & $~\mathrm{-}$ & wing lift coefficient \\
        $L/D$ & \ldots & $~\mathrm{-}$ & lift-to-drag ratio \\
        $Range$ & 3000 & $~\mathrm{km}$ & aircraft range \\
        $T_{flight}$ & \ldots & $~\mathrm{hr}$ & flight time \\
        \bottomrule
    \end{tabular}
    \caption{Variables introduced to define new performance metrics.}
    \label{t:vars_perfMetrics}
\end{table} \end{footnotesize}

An important note about variables that are potential alternate objectives: these variables
must always be lower-bounded (or inverted and upper-bounded) since the general \gls{GP} is a
minimization problem. However, if they are not also upper-bounded, these variables
will likely be unbounded for a given model and run off to +$\infty$. This means that
performance-quantifying variables will need to be in a monomial form,
or must be present in a posynomial objective
function as shown in Equation~\ref{e:posyobj} for boundedness. We shall see this coming into play
in Section~\ref{s:missionobj}.

\begin{equation}
    \mathrm{Objective} \geq \sum\limits^n_{i=1}c_{i}\prod\limits^n_{i=1}  v^{k_{i,j}}
    \label{e:posyobj}
\end{equation}

\subsection{More physics for boundedness: thrust and drag model}
\label{s:td}

If we attempt to run our current model, we would find that it is unbounded in many variables.
The results are shown in Table~\ref{t:WandL_unbounded}.

\begin{footnotesize}
\begin{table}
    \centering
    \begin{tabular}{ l c l }
        \toprule
        Unbounded variable & Units & Direction \\
        \midrule
        $S$ & $~\mathrm{m^{2}}$ & $\infty$ \\
        $T_{flight}$ & $~\mathrm{hr}$ & $\infty$ \\
        $V$ &  $~\mathrm{\tfrac{m}{s}}$  & $\infty$ \\
        $W_f$ & $~\mathrm{N}$ & $0$ \\
        $W_w$ & $~\mathrm{N}$  & $0$ \\
        \bottomrule
    \end{tabular}
    \caption{Unbounded variables in the weight and lift model.}
    \label{t:WandL_unbounded}
\end{table} \end{footnotesize}

This is not surprising at all, since none of the defined variables lower-bound $W_f$,
the objective function, in the constraints we have defined.
Without the pressure from the objective, any variables that
are not both upper- and lower- bounded will tend to blow up. This is indicative usually
that more modeling or direct substitutions are required to sufficiently bound the variables.

In this case, we lack a propulsion model which would properly bound fuel weight, velocity,
and time of flight. For initial modeling purposes, we assume a naive constant brake
specific fuel consumption (\BSFC) for the 'engine' of the aircraft, which is assumed
to provide as much thrust as needed. Since $T \geq D$:

\begin{equation}
    W_f \geq \BSFC \times T_{flight} \times DV
    \label{e:W_f}
\end{equation}

the fuel weight required is the product of the \BSFC, time of flight, and the
total drag power on the aircraft.
The drag of the aircraft is the product of dynamic pressure ($\frac{1}{2} \rho V^2$),
the planform area $S$, and the coefficient of drag of the aircraft:

\begin{equation}
    D \geq \frac{1}{2} \rho V^2 S C_D
    \label{e:d}
\end{equation}

There are yet more relaxed monomial equalities in Equations~\ref{e:W_f} and \ref{e:d}.
If the pressure on the \gls{LHS} or \gls{RHS} of a monomial equality are clear as in these cases,
it is a good practice to relax the equality to leave as many degrees of freedom
in the design space as possible. The intuition is that, we can almost always spend more fuel or have more drag,
but the constraints will always be tight since all objectives will suffer as a consequence.

The drag coefficient of the aircraft is assumed to be the sum of the fuselage drag,
the wing profile drag, and the wing induced drag coefficients \cite{gp_ac_design}:

\begin{equation}
    C_D \geq C_{D_{fuse}} + C_{D_{wpar}} + C_{D_{ind}}
\label{e:cd}
\end{equation}

The individual components of the drag are represented as monomial equalities, again borrowing
from \cite{gp_ac_design} for constraints~\ref{e:cdfuse} through~\ref{e:cdinduced}.
The fuselage drag is a function of its drag area $\CDA_0$ and the planform area of the wing:

\begin{equation}
    C_{D_{fuse}} = \frac{\CDA_0}{S}
\label{e:cdfuse}
\end{equation}

where the $\CDA_0$ is linearly proportional to the volume of fuel in the fuselage:

\begin{equation}
    V_{f_{fuse}} = \CDA_0 \times 10 ~\mathrm{[meters]}
\label{e:vffuse}
\end{equation}

Note that we correct the dimensionality of the volume here, since GPkit automatically checks units.

The wing profile drag is the product of the form factor, the friction drag coefficient,
and the wetted area ratio of the wing \cite{gp_ac_design},

\begin{equation}
    C_{D_{wpar}} = k C_f S_{wetratio}
\label{e:cdwpar}
\end{equation}

The Reynolds number of the aircraft wing is approximated

\begin{equation}
    Re \leq \frac{\rho}{\mu} V \sqrt{\frac{S}{\AR}}
\label{e:re}
\end{equation}

and used to find the friction drag coefficient of wing. We approximate the $C_f$ by assuming a
turbulent flat plate flow:

\begin{equation}
    C_f \geq \frac{0.074} {Re^{0.2}}
\end{equation}

The induced drag of the wing is calculated with a span efficiency factor $e$, and is a
function of the $C_L$ and aspect ratio \AR of the wing.

\begin{equation}
    C_{D_{induced}} = \frac{C_L^2}{\pi \AR e}
\label{e:cdinduced}
\end{equation}

The new variables are detailed in Table~\ref{t:vars_TandD}.

\begin{footnotesize}
\begin{table}
    \centering
    \begin{tabular}{ l c c l}
        \toprule
        \textbf{Variable} & \textbf{Value} & \textbf{Units} & \textbf{Description} \\
        \midrule
        \AR & \ldots & $-$ & aspect ratio\\
        $\BSFC$ & 400 & $\mathrm{\frac{g}{kW*hr}}$ & brake specific fuel consumption \\
        $\CDA_0$ & \ldots & $~\mathrm{m^{2}}$ & fuselage drag area \\
        $C_f$ & \ldots & $-$ & skin friction coefficient \\
        $D$ & \ldots & $~\mathrm{N}$ & total drag force \\
        $e$ & 0.92 & $-$ & Oswald efficiency factor \\
        $k$ & 1.17 & $-$ & form factor \\
        $\mu$ & $\mathrm{1.78 \times 10^{-5}}$ & $~\mathrm{\tfrac{kg}{m\cdot s}}$ & viscosity of air \\
        $Re$ & \ldots & $-$ & Reynolds number \\
        $\left(\frac{S}{S_{wet}}\right)$ & 2.075 & $-$ & wetted area ratio \\
        $V_{f_{fuse}}$ & $~\mathrm{m^{3}}$ & \ldots & fuel volume in the fuselage \\
        \bottomrule
    \end{tabular}
    \caption{Variables introduced in thrust and drag model.}
    \label{t:vars_TandD}
\end{table} \end{footnotesize}

%\begin{python}
%        # Thrust and drag model
%        C_D_fuse = CDA0 / S
%        C_D_wpar = k * C_f * S_wetratio
%        C_D_ind  = C_L ** 2 / (np.pi * A * e)
%        constraints += [W_f >= BSFC * T_flight * D,
%                    D >= 0.5 * rho * S * C_D * V ** 2,
%                    C_D >= C_D_fuse + C_D_wpar + C_D_ind,
%                    V_f_fuse == 10*units('m')*CDA0,
%                    Re <= (rho / mu) * V * (S / A) ** 0.5,
%                    C_f >= 0.074 / Re ** 0.2]
%\end{python}

As shown in Table~\ref{t:WLTD_unbounded}, attempting to run the model as is
results in both the fuselage fuel
volume $V_{f_{fuse}}$ and the wing weight $W_w$ still having no lower bounds.
These variables will need to be properly bounded to complete the SimPleAC model.

\begin{footnotesize}
    \begin{center}
        \begin{table}
            \begin{tabular}{ l c l }
                \toprule
                Unbounded variable & Units & Direction \\
                \midrule
                $V_{f_{fuse}}$ &  $~\mathrm{m^3}$  & $0$ \\
                $W_w$ & $~\mathrm{N}$  & $0$ \\
                \bottomrule
            \end{tabular}
            \caption{Unbounded variables within the GP formulation}
            \label{t:WLTD_unbounded}
        \end{table}
    \end{center}
\end{footnotesize}

\section{Limits of GP and Convexity, and SP modeling}
\label{s:GPlimits}

Even with the demonstrated strengths of \gls{GP}s in solving certain classes of
problems, it is important to recognize that the mathematical framework has limits.
The three distinct types of~\gls{GP}-incompatibility in design problems are detailed
by Hoburg~ \cite{hoburg_thesis}, which are discreteness,
quasi-convexity, and multi-modality. Discreteness in \gls{GP} can be approached
by coupling discrete programming methods such as branch-and-bound into a sequential
\gls{GP}. This is outside of the scope of this thesis.
Quasi-convexity and to a certain extent multimodality can
be addressed through a non-log-convex extension of \gls{GP}s called \gls{SP}s, where
certain constraints are expressed as signomial (or difference-of-posynomial) constraints
(described in greater detail in Appendix~\ref{a:spintro}).
Even the addition of a single
signomial constraint turns the problem from a \gls{GP} to a \gls{SP}, which means
that the problems loses convexity and all of the mathematical guarantees associated with it. 
It takes engineering intuition to recognize where and when improved modeling is worth
the loss of the mathematical guarantees. Kirschen~\cite{kirschen_thesis} describes in detail how
signomial constraints are often required to capture fundamental design tradeoffs.

\subsection{Signomial constraints: adding fuel volume model}
\label{s:fuel}

In an attempt to put a lower bound $V_{f_{fuse}}$, we will
be adding a fuel volume model to SimPleAC, where fuel can be stored in the wing or
in the fuselage. The fuel volume will be modeled first instead of the wing
weight because the wing weight will be a function of the fuel stored in the fuselage.
The reason why this model is \gls{GP}-incompatible is because of the
following constraint which follows logically:

\begin{equation}
	V_{f_{avail}} \leq V_{f_{wing}} + V_{f_{fuse}}
	\label{vfavail}
\end{equation}

The fuel volume available must be less than the sum of the fuel volume available in the
wing and the fuselage. It turns out that volumes that 'contain' free variables
can create signomial constraints. (One way around this is potentially creating fuel
fraction variables to denote how much fuel is stored in each volume, but
other potential parametrizations will not be explored here.)

As such, we can continue to develop the model, since it is important for us to
capture the fuel distribution between the wing and the fuselage. Fuel weight is going
to influence the lift required of the aircraft, so the weight of the fuel is determined
using a density parameter $\rho_{f}$. 

\begin{equation}
    V_f = \frac{W_f } {\rho_f g}
    \label{e:vf}
\end{equation}

We need a model of how much fuel volume there is in a wing. Intuitively,
we would expect the volume within a wing
to be related linearly to its thickness ratio ($\tau$) and span ($b$),
and to the square of its chord ($c$). 

\begin{equation}
	V_{f_{wing}} \propto \tau b c^2
	\label{e:vfwingpre}
\end{equation} 

It is convenient to express relation~\ref{e:vfwingpre} in terms of planform area $S$,
aspect ratio \AR~and thickness ratio $\tau$ only.
Using the additional relations $\AR = \frac{b^2}{S}$ and $S \propto b c$, we can
express $V_{f_{wing}}$.

\begin{equation}
	V_{f_{wing}} \propto \tau \left(\frac{\AR}{S}\right)^{0.5} \left(\frac{S}{b}\right)^2 \propto
		\left(\frac{\AR}{S}\right)^{0.5} \frac{S^2}{S \AR} \propto \frac{\sqrt{S}\tau}{\sqrt{\AR}}
\end{equation}

\begin{equation}
\label{e:vfwing}
V_{f_{wing}}^2 \leq 9\times10^{-4} \mathrm{m}^4 \times \frac{S \tau^2}{\AR}
\end{equation}

Such variable transformations can be useful to have a minimal parametrization of designs.
One can solve the minimal problem, and
post-process the results of the optimization problem to get a complete geometry
as necessary. The new variables introduced to bound fuel volume are in Table~\ref{t:vars_fuelmodel}.
(In the final form of the Equation~\ref{e:vfwing} the constant $9\times10^{-4} \mathrm{m}^4$ was picked as the coefficient in
front of the relation by tuning it after the model was developed,
but any other coefficient would work.)

\begin{footnotesize}
\begin{table}
    \centering
    \begin{tabular}{ l c c l}
        \toprule
        \textbf{Variable} & \textbf{Value} & \textbf{Units} & \textbf{Description} \\
        \midrule
        $\rho_f$ & 817 & $~\mathrm{\tfrac{kg}{m^{3}}}$ & density of fuel \\
        $g$ & 9.81 & $~\mathrm{\tfrac{m}{s^{2}}}$ & gravitational acceleration \\
        $\tau$ & 0.12 & $$ & airfoil thickness to chord ratio \\
        $V_f$ & \ldots & $~\mathrm{m^{3}}$ & fuel volume \\
        $V_{f_{avail}}$ & \ldots & $~\mathrm{m^{3}}$ & fuel volume available \\
        $V_{f_{wing}}$ & \ldots & $~\mathrm{m^{3}}$ & fuel volume in the wing \\
        \bottomrule
    \end{tabular}
    \caption{Variables introduced in the fuel model.}
    \label{t:vars_fuelmodel}
\end{table} \end{footnotesize}

\subsection{Arguments for the signomial equality}
\label{s:sigeq}

This segue will explain and motivate the use of signomial equalities,
as described in~\cite{sigeqpaper}, in \gls{SP} modeling.
Signomial equalities must be used as a last resort. The signomial equality is the only place
where the feasibility set of individual \gls{GP}'s within a \gls{SP} solve are not guaranteed
to be subsets of the feasibility set of the \gls{SP}. This is because the signomial solution
algorithm in GPkit flattens the original signomial equality constraint,
a concave curve in log-space in $n$-dimensions,
onto a line in log-space in $n$-dimensions(Method C in~\cite{sigeqpaper}) that intersects the
original constraint at the optimal point of the last \gls{GP} solve. This is undesirable, although
the final solution of the \gls{SP} with equalities
is guaranteed to be in the feasibility region of the \gls{SP}. Furthermore, \gls{SP}s
with signomial equalities have been demonstrated to require more \gls{GP} solves
than \gls{SP}s without signomial equalities. However, there are a few arguments
to be made in defense of signomial equalities.

One good use case of the signomial equalities is in constraints in which the direction
of pressure on free variables is not clear. This ensures the tightness of constraints
that may otherwise have unbounded variables. A good example is in atmospheric models.
Although the pressure on air viscosity $\mu$ is almost certainly downward since it results in
lower drag, the pressure on air density $\rho$ is not clear because of the tradeoffs between
aircraft endurance and range.

The second reason is that we are not interested in the 'feasibility set' of the atmosphere,
since this has no intuition behind it: at every altitude, the atmospheric quantities
can only be be represented by single quantities. Additionally, the computational penalty of
implementing signomial equalities in atmospheric models is low, since the monomial approximation
to the atmospheric data is not far from the monomial approximations made to the signomial equality.
In fact, when we add an atmospheric model to SimPleAC in
Section~\ref{s:mission}, we will be implementing signomial equalities to represent both air density
$\rho$ and viscosity $\mu$.

\subsection{Completing the model: wing structural model}
\label{s:wingstrc}

Only one unbounded variable remains, which is wing weight $W_w$. We can think
of wing weight having two components, the skin weight that
only grows as a function of wing area and the structural weight which is a function of
both the geometry and loading. The surface weight expression is straightforward.

\begin{equation} W_{w_{surf}} \geq W_{w_{coeff2}} S \label{e:wwsurf} \end{equation}

We would like wing structural weight to account for the loading distribution and the geometry
of the wing. The wing will have to sustain a maximum bending load (I will neglect shear, since
the two are coupled) due to maximum takeoff weight,
multiplied by an ultimate structural factor $N_{ult}$ for maneuvering.
I have borrowed the wing weight model from \cite{gp_ac_design}, and adapted it through a
structural weight coefficient $W_{w_{coeff1}}$. Note that this equation captures the
major trends in wing structural sizing. We can see this through looking at the partial
derivatives of the wing weight with respect to the different free variables.
The weight grows with the cube of the span ($AR^{1.5} = \frac{b^3}{S_{constant}^{1.5}}$, derived
from the integration of a quadratically increasing bending moment),
linearly with the maximum structural factor $N_{ult}$, and inversely with the
surface area \footnotemark. Using similar partial-derivative based analyses, it
is often easy to make first-order models for components.

\footnotetext{This can be difficult to see, but since $S \propto b_{constant} c$ and loading is constant, as area
grows, the thickness of the wing grows as well at a constant $\tau$. So the weight increases linearly with S,
and stiffness increases with the cube of S.
Integrated over the whole wing this yields a $S^{-1}$ relation.}

\begin{equation} W_{w_{strc}} \geq \frac{W_{w_{coeff1}}}{\tau}
N_{ult} AR ^ {1.5} \sqrt{(W_0+\rho_fgV_{f_{fuse}}) WS} \label{e:wwstrc}
\end{equation}

Equation~\ref{e:wwstrc} takes into account the root
bending moment relief due to presence of fuel and weight in the wings by performing a
geometric average of the total weight, and the weight excluding wing fuel and wing weight.

The total wing weight is now lower-bounded by its component weights, and we have introduced
the final set of variables in Table~\ref{t:vars_wingstrcmodel}.

\begin{equation} W_w \geq W_{w_{surf}} + W_{w_{strc}} \label{e:ww} \end{equation}

\begin{footnotesize}
\begin{table}
    \centering
    \begin{tabular}{ l c c l}
        \toprule
        \textbf{Variable} & \textbf{Value} & \textbf{Units} & \textbf{Description} \\
        \midrule
        $N_{ult}$ & 3.3 & $-$ & ultimate load factor \\
        $W_{w_{coeff1}}$ & $\mathrm{2\times 10^{-5}}$ & $~\mathrm{\tfrac{1}{m}}$ & wing weight coefficient 1 \\
        $W_{w_{coeff2}}$ & 60 & $~\mathrm{Pa}$ & wing weight coefficient 2 \\
        $W_{w_{strc}}$ & \ldots & $~\mathrm{N}$ & wing structural weight \\
        $W_{w_{surf}}$ & \ldots & $~\mathrm{N}$ & wing skin weight \\
    \bottomrule
    \end{tabular}
    \caption{Variables introduced in the wing structural model.}
    \label{t:vars_wingstrcmodel}
\end{table} \end{footnotesize}

\section{Results of SimPleAC}

The benefits of convex optimization and \gls{GP} in both solution
quality (in terms of mathematical guarantees) and the low-cost
computation of sensitivities has been detailed in (\cite{gp_ac_design},\cite{sp_ac_design}),
so these benefits will not be featured here. However, the values of the free variables,
and the sensitivities of the fixed parameters are presented for the reader.

\begin{center}
\captionof{table}{Values of the free variables in the SimPleAC model.}
\input{tables/SimPleAC_results.tex}
    \label{t:SimPleAC_results}
\end{center}

\begin{center}
\captionof{table}{Sensitivities of parameters in the SimPleAC model.}
\input{tables/SimPleAC_sens.tex}
    \label{t:SimPleAC_sens}
\end{center}



